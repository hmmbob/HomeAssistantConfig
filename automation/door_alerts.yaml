##########################
## Freezer door alert
##########################
- id: freezer_door_left_open
  alias: "Doors: Freezer door left open"
  trigger:
    platform: state
    entity_id: binary_sensor.door_contact_1
    from: 'off'
    to: 'on'
    for:
      minutes: 2
  action:
  - service: script.notify_door_open
    data:
      title: 'Vriezer'
      message: 'Let op: de vriezer is nog open!'
  - service: timer.start #2min timer to reannounce that door is open
    data:
      entity_id: timer.freezer_door_open

- id: freezer_door_left_open_timer
  alias: "Doors: Freezer door timer"
  trigger:
  - platform: event
    event_type: timer.finished
    event_data:
      entity_id: timer.freezer_door_open
  condition:
  - condition: state  #Stop if door has been closed
    entity_id: binary_sensor.door_contact_1
    state: 'on'
  action:
  - service: script.turn_on
    entity_id: script.notify_door_open
    data:
      variables:
        title: "Vriezer"
        message: "Let op: de vriezer is nog open!"
  - service: timer.start #Start timer all over again
    data:
      entity_id: timer.freezer_door_open

##########################
## Front door alert
##########################
- id: front_door_left_open
  alias: "Doors: Front door left open"
  trigger:
    platform: state
    entity_id: binary_sensor.door_contact_2
    from: 'off'
    to: 'on'
    for:
      minutes: 2
  action:
  - service: script.notify_door_open
    data:
      title: 'Voordeur'
      message: 'Let op: de voordeur is nog open!'
  - service: timer.start 
    data:
      entity_id: timer.front_door_open

- id: front_door_left_open_timer
  alias: "Doors: Front door timer"
  trigger:
  - platform: event
    event_type: timer.finished
    event_data:
      entity_id: timer.front_door_open
  condition:
  - condition: state  
    entity_id: binary_sensor.door_contact_2
    state: 'on'
  action:
  - service: script.turn_on
    entity_id: script.notify_door_open
    data:
      variables:
        title: "Voordeur"
        message: "Let op: de voordeur is nog open!"
  - service: timer.start 
    data:
      entity_id: timer.front_door_open
