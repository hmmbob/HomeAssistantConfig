##########################
## OpenUV 
##########################
  - alias: 'OpenUV: Update UV Index'
    trigger:
      platform: time_pattern
      minutes: '/30'    # Every 30min will not bust API of 50/day
    condition:
      condition: and
      conditions:
        - condition: sun
          after: sunrise
        - condition: sun
          before: sunset
    action:
      service: openuv.update_uv_index_data

  - alias: 'OpenUV: Update OpenUV protection window'
    trigger:
      platform: time    #Once a day is fine for this service
      at: "05:12:00"
    action:
      service: openuv.update_protection_data

  - alias: 'OpenUV: Melding vandaag'
    id: melding_openuv_vandaag
    initial_state: true
    trigger:
      platform: time
      at: '08:15:00'
    condition:
      - condition: state
        entity_id: input_boolean.notify_uv
        state: 'on'
      - condition: template
        value_template: "{{ states('sensor.max_uv_index') | float > 5.9 }}"
    action:
      - service: notify.mobile_devices
        data_template:
          title: "UV Waarschuwing"
          message: "Vandaag wordt zonkracht {{ states('sensor.max_uv_index') | round(1) }} verwacht. Vergeet niet te smeren!"
        data:
          data:
            tag: 'notification-uv'
      - condition: state
        entity_id: input_boolean.notify_uv_voice
        state: 'on' 
      - service: tts.google_translate_say
        entity_id: media_player.woonkamer
        data_template:
          message: "Vandaag wordt zonkracht {{ states('sensor.max_uv_index') | round(1) }} verwacht. Goed insmeren dus!"
          language: 'nl'
      - delay: '00:00:04'
      - wait_template: "{{ is_state('media_player.woonkamer', 'idle') }}" # Ensure Home Hub screen is back to photo mode
      - service: media_player.turn_off  
        entity_id: 
          - media_player.woonkamer