#################################################################
## Home Assistant Core
#################################################################
homeassistant:
  customize: !include includes/customize.yaml
  auth_providers:
    - type: homeassistant
  auth_mfa_modules:
    - type: totp
      name: Authenticator app
    - type: notify
      message: "Access token: {}"
      include:
        - mobile_app_sm_a526b

frontend:
  themes: !include_dir_merge_named themes/
  extra_module_url:
    - /hacsfiles/lovelace-card-mod/card-mod.js

history:
  include: !include includes/recorder-history.yaml
  exclude:
    entity_globs:
      - binary_sensor.sm_a52*
      - binary_sensor.sm_a33_*
      - binary_sensor.schad*
      - binary_sensor.*_over_load_*

http:
  server_port: !secret http_server_port
  ip_ban_enabled: true
  login_attempts_threshold: 2
  use_x_forwarded_for: true
  trusted_proxies: !secret http_trusted_proxies

logbook:
  exclude:
    entities:
      - sensor.kamertemperatuur
    entity_globs:
      - binary_sensor.pir*
      - binary_sensor.sm_a52*
      - binary_sensor.sm_a33_*
      - binary_sensor.schad*
      - media_player.*
    domains:
      - input_boolean

logger:
  default: warn
  logs:
    homeassistant.components.analytics: info # I'd like to see what is sent
  filters:
    aioesphomeapi.reconnect_logic:
      # This device has weak wifi connection, just mute the reconnect logs
      - "weerhuisje"
    custom_components.toon_climate.climate:
      # Occasionaly Toon doesn't reply
      - "Cannot poll Woonkamer"
      - "Timeout error occurred while polling"
    homeassistant.components.esphome:
      - "Error getting initial data"
      - "Timeout waiting for response"
    homeassistant.components.rest_command:
      # The other server isn't too stable
      - "Connection reset by peer"
      - "Server disconnected"
      - "Status code 502"
      - "Timeout call"
    homeassistant.components.rituals_perfume_genie:
      - "Cannot connect to host"
    pychromecast.socket_client:
      # Mute cast reconnection warnings/errors
      - "Error communicating with socket, resetting connection"
      - "Error reading from socket"
      - "Failed to connect to service ServiceInfo"
      - "Heartbeat timeout, resetting connection"

lovelace:
  mode: yaml
  resources: !include dashboards/resources.yaml
  dashboards:
    lovelace-cast:
      mode: yaml
      filename: dashboards/cast/cast.yaml
      title: Cast views
      icon: mdi:cast
      show_in_sidebar: true
      require_admin: true
    lovelace-map:
      mode: yaml
      filename: dashboards/map/map.yaml
      title: Map
      icon: mdi:map
      show_in_sidebar: true
      require_admin: false

recorder:
  db_url: !secret recorder_url
  purge_keep_days: 31
  include: !include includes/recorder-history.yaml

#################################################################
## Includes
#################################################################
alert: !include includes/alert.yaml
automation: !include automations.yaml
automation split: !include_dir_merge_list automation/
binary_sensor: !include includes/binary_sensor.yaml
camera: !include includes/camera.yaml
emulated_hue: !include includes/emulated_hue.yaml
google_assistant: !include includes/googleassistant.yaml
group: !include includes/groups.yaml
input_boolean: !include includes/input_boolean.yaml
input_datetime: !include includes/input_datetime.yaml
input_select: !include includes/input_select.yaml
input_text: !include includes/input_text.yaml
multiscrape: !include includes/multiscrape.yaml
notify: !include includes/notify.yaml
rest: !include includes/rest.yaml
rest_command: !include includes/rest_command.yaml
scene: !include includes/scenes.yaml
schedule: !include includes/schedule.yaml
script: !include scripts.yaml
script split: !include_dir_merge_named scripts/
sensor: !include includes/sensors.yaml
template: !include includes/template.yaml

#################################################################
## default_config items not included elsewhere
#################################################################
#default_config:
application_credentials:
backup:
bluetooth:
cloud:
# debugpy:
dhcp:
diagnostics:
homeassistant_alerts:
input_button:
# map:
media_source:
mobile_app:
my:
person:
ssdp:
stream:
sun:
system_health:
webhook:
zeroconf:

#################################################################
## Components not using includes
#################################################################
climate:
  - platform: toon_climate
    name: Woonkamer
    host: !secret toon_host
    scan_interval: 15

ffmpeg:

mqtt:
  binary_sensor: # Sensor for monitoring the bridge state
    - unique_id: zigbee2mqtt_bridge
      name: Zigbee2mqtt Bridge
      state_topic: "zigbee2mqtt/bridge/state"
      payload_on: "online"
      payload_off: "offline"
      availability_topic: "zigbee2mqtt/bridge/state"
      payload_available: "online"
      payload_not_available: "offline"
      device_class: connectivity

sonoff:
  username: !secret sonoff_username
  password: !secret sonoff_password

spotcast:
  sp_dc: !secret spotcast_sp_dc
  sp_key: !secret spotcast_sp_key
  accounts:
    t:
      sp_dc: !secret spotcast_t_sp_dc
      sp_key: !secret spotcast_t_sp_key

tts:
  - platform: microsoft
    api_key: !secret tts_azure_api_key
    region: westeurope
    language: nl-nl
    type: ColetteNeural

weather:
  - platform: darksky
    api_key: !secret darksky_api
    mode: daily
