wakeup_light_mini_package:
  automation:
    - id: wakeup_light_mini
      alias: "Wakeup light mini"
      mode: single
      triggers:
        - alias: Alarmtijd bereikt volgens apparaat
          trigger: time
          at: sensor.home_mini_slaapkamer_t_alarms
      conditions: []
      actions:
        - alias: Wacht tot systeem stabiel is
          delay: 00:00:01
        - alias: Start met licht op minimale helderheid
          action: light.turn_on
          data:
            brightness_pct: 5
          target:
            entity_id:
              - light.ledstrip_bed_mini
        - alias: Wacht kort
          delay: 00:00:02
        - alias: Verhoog helderheid stap voor stap totdat max
          repeat:
            sequence:
              - alias: Verhoog helderheid van ledstrip
                service: light.turn_on
                data:
                  entity_id: light.ledstrip_bed_mini
                  brightness: "{{ state_attr('light.ledstrip_bed_mini', 'brightness') | int + 15 }}"
              - alias: Wacht kort tussen stappen
                delay: 2
            until:
              condition: or
              conditions:
                - alias: Helderheid bereikt maximum
                  condition: template
                  value_template: "{{ state_attr('light.ledstrip_bed_mini', 'brightness') | int >= 191 }}"
                - alias: Licht is uitgeschakeld
                  condition: state
                  entity_id: light.ledstrip_bed_mini
                  state: "off"
        - alias: Wacht 10 minuten voordat licht automatisch uitgaat
          delay: 00:10:00
        - alias: Zet licht uit
          action: light.turn_off
          target:
            entity_id: light.ledstrip_bed_mini

    - id: turn_off_lights_t_when_starting_google_home_sleeping_sounds
      alias: "Lampen slaapkamer T uit als 'zomerse nachtgeluiden' beginnen"
      mode: queued
      triggers:
        - alias: Slaapgeluiden starten op speaker
          trigger: state
          entity_id: media_player.slaapkamer_t
          attribute: app_id
          to: "9731D581"
          for: "00:00:02"
      conditions:
      actions:
        - alias: Zet speaker volume op gemiddeld
          action: media_player.volume_set
          data:
            entity_id: media_player.slaapkamer_t
            volume_level: 0.4
        - alias: Zet licht uit als deze aan is
          if:
            - condition: state
              entity_id: light.ledstrip_bed_mini
              state: "on"
          then:
            - alias: Dim ledstrip uit
              action: light.turn_off
              target:
                entity_id: light.ledstrip_bed_mini
              data:
                transition: 5
        - alias: Wacht lang voordat volume wordt verlaagd
          delay: 00:40:00
        - alias: Verlaag speaker volume
          action: media_player.volume_set
          data:
            entity_id: media_player.slaapkamer_t
            volume_level: 0.3
        - alias: Wacht voor verdere verlaging
          delay: 00:05:00
        - alias: Verlaag speaker volume nog verder
          action: media_player.volume_set
          data:
            entity_id: media_player.slaapkamer_t
            volume_level: 0.1
        - alias: Zet speaker uit
          action: media_player.turn_off
          data:
            entity_id: media_player.slaapkamer_t
