notify_door_open:
  sequence:
    - service: tts.google_translate_say
      entity_id: media_player.woonkamer
      data_template:
        message: "{{ message }}"
        language: nl
    - service: notify.mobile_app_sm_a505fn
      data_template:
        message: "{{ message }} ({{ now().strftime('%H') }}:{{now().strftime('%M') }})."
        title: "{{ title }}"
      data:
        data:
          tag: 'open_door'
          actions:
          - action: notify_door_alert
            title: "10 min dempen"
    - service: logbook.log
      data_template:
        name: "{{ title }}: " 
        message: "{{ message }} ({{ now().strftime('%H') }}:{{now().strftime('%M') }})."

ring_doorbell_downstairs:
  sequence:
  - condition: time
    after: '07:00:00'
    before: '22:00:00'
  - service: media_player.volume_set
    data:
      entity_id: media_player.woonkamer
      volume_level: 0.8
  - service: media_player.play_media
    data:
      entity_id: media_player.woonkamer
      media_content_id: !secret doorbell_url
      media_content_type: music
  - delay: '00:00:02'
  - wait_template: "{{ is_state('media_player.woonkamer', 'idle') }}" # Ensure Home Hub screen is back to photo mode
  - service: media_player.volume_set
    data:
      entity_id: media_player.woonkamer
      volume_level: 0.5
  - service: media_player.turn_off  
    entity_id: 
      - media_player.woonkamer

ring_doorbell_upstairs:
  sequence:
  - condition: time
    after: '08:00:00'
    before: '19:00:00'
  - service: media_player.play_media
    data:
      entity_id: 
        - media_player.studeerkamer
        - media_player.zolder
        - media_player.hmt
      media_content_id: !secret doorbell_url
      media_content_type: music
  - delay: '00:00:15'
  - service: media_player.turn_off  
    entity_id: 
        - media_player.studeerkamer
        - media_player.zolder
        - media_player.hmt

show_doorbell_alert:
  sequence:
  - condition: state
    entity_id: media_player.tv_beneden
    state: 'off' # Device actually is 'unavailable' when off and shows 'off' when turned on
  - service: notify.tv
    data:
      title: "Deurbel!"
      message: "Er staat iemand aan de deur"
      data:
        fontsize: "large"
        position: "top-right"
        duration: 10
        transparency: "50%"
        color: "grey"

update_zigbee_network_map:
  sequence:
    - service: zigbee2mqtt_networkmap.update


